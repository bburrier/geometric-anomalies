<html>
    <head>
        <meta name="viewport" content="initial-scale=0.75, maximum-scale=1">
        <link href="static/css/index.css" rel="stylesheet"/>
    </head>

    <script>
        function Sketch(canvasId, params) {
            let canvas, ctx;
            let w, h;

            function debounced(f, delay) {
                var timeoutId = setTimeout(f, delay);
                return function() {
                    clearTimeout(timeoutId);
                    timeoutId = setTimeout(f, delay);
                }
            }

            function getFillColor(){
                let fillIndex = Math.floor(Math.random() * params.fillColors.length);
                return params.fillColors[fillIndex];
            }

            function draw() {
                canvas = document.getElementById(canvasId);
                ctx = canvas.getContext('2d');
                w = canvas.width;
                h = canvas.height;

                drawBars()
                canvas.addEventListener("mousemove", debounced(drawBars, 5));
            }

            function drawBars(){
                for(let j=0; j < w; j += params.strokeWidth + params.whitespace) {
                    for(let i=0; i < h; i += params.strokeHeight) {

                        ctx.beginPath()
                        ctx.fillStyle = getFillColor();

                        ctx.fillRect(
                            j, 
                            i, 
                            params.strokeWidth, 
                            params.strokeHeight
                        )
                    }
                }
            }

            draw();
            return {
                draw,
            };
        }

        function init() {
            let sketch1 = Sketch("sketch-1", {
                strokeWidth: 24,
                strokeHeight: 24,
                whitespace: 0,
                fillColors: ["#333", "#0a4a90",]
            });

            let sketch2 = Sketch("sketch-2", {
                strokeWidth: 10,
                strokeHeight: 10,
                whitespace: 10,
                fillColors: ["#373333", "#DDD",]
            });
        }

        document.addEventListener('DOMContentLoaded', init)
    </script>
    
    <body>
        <main>
            <section id="masthead">
                <h1>Geometric Anomalies</h1>
                <summary>
                    Exploring simple generative art with vanilla JS and <code>&lt;canvas&gt;</code>.
                </summary>
            </section>
            
            <canvas class="sketch" id="sketch-1" width="300" height="300"></canvas>
            <canvas class="sketch" id="sketch-2" width="300" height="300"></canvas>
        </main>
    </body>

</html>